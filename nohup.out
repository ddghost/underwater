loading annotations into memory...
loading annotations into memory...
loading annotations into memory...
loading annotations into memory...
Done (t=0.01s)
creating index...
index created!
Done (t=0.01s)Done (t=0.02s)

creating index...creating index...

index created!
index created!
Done (t=0.01s)
creating index...
index created!
[                                                  ] 0/800, elapsed: 0s, ETA:Traceback (most recent call last):
  File "./tools/test.py", line 176, in <module>
    main()
  File "./tools/test.py", line 160, in main
    args.gpu_collect)
  File "/home/huangzixuan/underwater/mmdet/apis/test.py", line 58, in multi_gpu_test
    result = model(return_loss=False, rescale=True, **data)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/parallel/distributed.py", line 442, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/decorators.py", line 75, in new_func
    output = old_func(*new_args, **new_kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/base.py", line 139, in forward
    return self.forward_test(img, img_meta, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/base.py", line 124, in forward_test
    return self.aug_test(imgs, img_metas, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/cascade_rcnn.py", line 414, in aug_test
    self.extract_feats(imgs), img_metas, self.test_cfg.rpn)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/test_mixins.py", line 41, in aug_test_rpn
    proposal_list = self.simple_test_rpn(x, img_meta, rpn_test_cfg)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/test_mixins.py", line 34, in simple_test_rpn
    proposal_list = self.rpn_head.get_bboxes(*proposal_inputs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/decorators.py", line 152, in new_func
    output = old_func(*new_args, **new_kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/anchor_heads/anchor_head.py", line 276, in get_bboxes
    scale_factor, cfg, rescale)
  File "/home/huangzixuan/underwater/mmdet/models/anchor_heads/rpn_head.py", line 92, in get_bboxes_single
    proposals, _ = nms(proposals, cfg.nms_thr)
  File "/home/huangzixuan/underwater/mmdet/ops/nms/nms_wrapper.py", line 54, in nms
    inds = nms_cuda.nms(dets_th, iou_thr)
RuntimeError: CUDA error: invalid device function (launch_kernel at /opt/conda/conda-bld/pytorch_1570910687650/work/aten/src/ATen/native/cuda/Loops.cuh:102)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x47 (0x7f617be7f687 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: void at::native::gpu_index_kernel<__nv_dl_wrapper_t<__nv_dl_tag<void (*)(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>), &(void at::native::index_kernel_impl<at::native::OpaqueType<8> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>)), 1u>> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>, __nv_dl_wrapper_t<__nv_dl_tag<void (*)(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>), &(void at::native::index_kernel_impl<at::native::OpaqueType<8> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>)), 1u>> const&) + 0x78d (0x7f6182f6707d in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #2: <unknown function> + 0x543e822 (0x7f6182f60822 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x543ecd8 (0x7f6182f60cd8 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #4: <unknown function> + 0x16a5efb (0x7f617f1c7efb in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #5: at::native::index(at::Tensor const&, c10::ArrayRef<at::Tensor>) + 0x44e (0x7f617f1c2d2e in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #6: <unknown function> + 0x1b9d04a (0x7f617f6bf04a in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #7: <unknown function> + 0x366f7ad (0x7f61811917ad in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #8: at::Tensor::index(c10::ArrayRef<at::Tensor>) const + 0xbb (0x7f6180e5853b in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #9: nms_cuda(at::Tensor, float) + 0x827 (0x7f61589b2bd0 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #10: nms(at::Tensor const&, float) + 0x318 (0x7f61589a16f8 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #11: <unknown function> + 0x42cdd (0x7f61589b0cdd in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #12: <unknown function> + 0x3fa61 (0x7f61589ada61 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #13: _PyMethodDef_RawFastCallKeywords + 0x264 (0x555fd2132c34 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #14: _PyCFunction_FastCallKeywords + 0x21 (0x555fd2132d51 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #15: _PyEval_EvalFrameDefault + 0x4ebc (0x555fd219f0ac in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #16: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #17: _PyFunction_FastCallKeywords + 0x325 (0x555fd21323d5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #18: _PyEval_EvalFrameDefault + 0x416 (0x555fd219a606 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #19: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #20: _PyFunction_FastCallKeywords + 0x325 (0x555fd21323d5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #21: _PyEval_EvalFrameDefault + 0x4b29 (0x555fd219ed19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #22: _PyEval_EvalCodeWithName + 0xab8 (0x555fd20e2978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #23: _PyFunction_FastCallDict + 0x1d5 (0x555fd20e32a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #25: _PyEval_EvalCodeWithName + 0xab8 (0x555fd20e2978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #26: _PyFunction_FastCallDict + 0x1d5 (0x555fd20e32a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #27: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #28: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #29: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #30: _PyFunction_FastCallKeywords + 0xfb (0x555fd21321ab in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #31: _PyEval_EvalFrameDefault + 0x4b29 (0x555fd219ed19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #32: _PyEval_EvalCodeWithName + 0xab8 (0x555fd20e2978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #33: _PyFunction_FastCallKeywords + 0x387 (0x555fd2132437 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #34: _PyEval_EvalFrameDefault + 0x4b29 (0x555fd219ed19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #35: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #36: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #37: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #38: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #40: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #41: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #42: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #43: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #44: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #45: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #46: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #47: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #48: _PyEval_EvalCodeWithName + 0xab8 (0x555fd20e2978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #49: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #50: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #51: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #52: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #53: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #54: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #55: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #56: <unknown function> + 0x16a2da (0x555fd21392da in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #57: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #58: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #59: _PyEval_EvalCodeWithName + 0x2f9 (0x555fd20e21b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #60: _PyFunction_FastCallDict + 0x3ff (0x555fd20e34cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #61: _PyObject_Call_Prepend + 0x63 (0x555fd2101e33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #62: PyObject_Call + 0x6e (0x555fd20f4a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #63: _PyEval_EvalFrameDefault + 0x1f3a (0x555fd219c12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)

Traceback (most recent call last):
  File "./tools/test.py", line 176, in <module>
    main()
  File "./tools/test.py", line 160, in main
    args.gpu_collect)
  File "/home/huangzixuan/underwater/mmdet/apis/test.py", line 58, in multi_gpu_test
    result = model(return_loss=False, rescale=True, **data)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/parallel/distributed.py", line 440, in forward
    inputs, kwargs = self.scatter(inputs, kwargs, self.device_ids)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/distributed.py", line 10, in scatter
    return scatter_kwargs(inputs, kwargs, device_ids, dim=self.dim)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 48, in scatter_kwargs
    kwargs = scatter(kwargs, target_gpus, dim) if kwargs else []
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 40, in scatter
    return scatter_map(inputs)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 30, in scatter_map
    out = list(map(type(obj), zip(*map(scatter_map, obj.items()))))
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 25, in scatter_map
    return list(zip(*map(scatter_map, obj)))
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 27, in scatter_map
    out = list(map(list, zip(*map(scatter_map, obj))))
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/mmcv/parallel/scatter_gather.py", line 18, in scatter_map
    return OrigScatter.apply(target_gpus, None, dim, obj)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/parallel/_functions.py", line 89, in forward
    outputs = comm.scatter(input, target_gpus, chunk_sizes, ctx.dim, streams)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/cuda/comm.py", line 147, in scatter
    return tuple(torch._C._scatter(tensor, devices, chunk_sizes, dim, streams))
RuntimeError: CUDA out of memory. Tried to allocate 30.00 MiB (GPU 0; 10.92 GiB total capacity; 793.88 MiB already allocated; 29.19 MiB free; 30.12 MiB cached) (malloc at /opt/conda/conda-bld/pytorch_1570910687650/work/c10/cuda/CUDACachingAllocator.cpp:267)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x47 (0x7f06cd813687 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1ea29 (0x7f06cda56a29 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1fade (0x7f06cda57ade in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libc10_cuda.so)
frame #3: at::native::empty_cuda(c10::ArrayRef<long>, c10::TensorOptions const&, c10::optional<c10::MemoryFormat>) + 0x26d (0x7f06d4ce080d in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #4: <unknown function> + 0x3e21d08 (0x7f06d32d7d08 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #5: <unknown function> + 0x38db3f8 (0x7f06d2d913f8 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #6: <unknown function> + 0x1830cf1 (0x7f06d0ce6cf1 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #7: at::native::to(at::Tensor const&, c10::TensorOptions const&, bool, bool) + 0x272 (0x7f06d0ce7692 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #8: <unknown function> + 0x1b5a310 (0x7f06d1010310 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #9: <unknown function> + 0x36ed043 (0x7f06d2ba3043 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #10: torch::cuda::scatter(at::Tensor const&, c10::ArrayRef<long>, c10::optional<std::vector<long, std::allocator<long> > > const&, long, c10::optional<std::vector<c10::optional<c10::cuda::CUDAStream>, std::allocator<c10::optional<c10::cuda::CUDAStream> > > > const&) + 0x4db (0x7f06d36cd8db in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #11: <unknown function> + 0x793cbb (0x7f0701b34cbb in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #12: <unknown function> + 0x206506 (0x7f07015a7506 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #13: _PyMethodDef_RawFastCallKeywords + 0x264 (0x559defa2bc34 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #14: _PyCFunction_FastCallKeywords + 0x21 (0x559defa2bd51 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #15: _PyEval_EvalFrameDefault + 0x4ebc (0x559defa980ac in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #16: _PyEval_EvalCodeWithName + 0x2f9 (0x559def9db1b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #17: _PyFunction_FastCallKeywords + 0x325 (0x559defa2b3d5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #18: _PyEval_EvalFrameDefault + 0x4b29 (0x559defa97d19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #19: _PyFunction_FastCallDict + 0x10b (0x559def9dc1db in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #20: THPFunction_apply(_object*, _object*) + 0x8d6 (0x7f0701840e96 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch_python.so)
frame #21: _PyMethodDef_RawFastCallKeywords + 0x1e0 (0x559defa2bbb0 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #22: _PyCFunction_FastCallKeywords + 0x21 (0x559defa2bd51 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #23: _PyEval_EvalFrameDefault + 0x4ebc (0x559defa980ac in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #24: _PyEval_EvalCodeWithName + 0xab8 (0x559def9db978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #25: _PyFunction_FastCallDict + 0x1d5 (0x559def9dc2a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #26: <unknown function> + 0x151ce2 (0x559defa19ce2 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #27: PyIter_Next + 0xe (0x559def9ee90e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #28: PySequence_Tuple + 0xfb (0x559defa5628b in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #29: _PyEval_EvalFrameDefault + 0x5d63 (0x559defa98f53 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #30: _PyEval_EvalCodeWithName + 0xab8 (0x559def9db978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #31: _PyFunction_FastCallDict + 0x1d5 (0x559def9dc2a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #32: <unknown function> + 0x151ce2 (0x559defa19ce2 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #33: PyIter_Next + 0xe (0x559def9ee90e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #34: PySequence_Tuple + 0xfb (0x559defa5628b in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #35: _PyEval_EvalFrameDefault + 0x5d63 (0x559defa98f53 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #36: _PyEval_EvalCodeWithName + 0xab8 (0x559def9db978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #37: _PyFunction_FastCallDict + 0x1d5 (0x559def9dc2a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #38: <unknown function> + 0x151ce2 (0x559defa19ce2 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #39: PyIter_Next + 0xe (0x559def9ee90e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #40: PySequence_Tuple + 0xfb (0x559defa5628b in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #41: _PyEval_EvalFrameDefault + 0x5d63 (0x559defa98f53 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #42: _PyEval_EvalCodeWithName + 0xab8 (0x559def9db978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #43: _PyFunction_FastCallKeywords + 0x387 (0x559defa2b437 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #44: _PyEval_EvalFrameDefault + 0x416 (0x559defa93606 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #45: _PyEval_EvalCodeWithName + 0xab8 (0x559def9db978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #46: _PyFunction_FastCallKeywords + 0x387 (0x559defa2b437 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #47: _PyEval_EvalFrameDefault + 0x416 (0x559defa93606 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #48: _PyEval_EvalCodeWithName + 0x2f9 (0x559def9db1b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #49: _PyFunction_FastCallKeywords + 0x387 (0x559defa2b437 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #50: _PyEval_EvalFrameDefault + 0x14eb (0x559defa946db in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #51: _PyFunction_FastCallKeywords + 0xfb (0x559defa2b1ab in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #52: _PyEval_EvalFrameDefault + 0x4b29 (0x559defa97d19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #53: _PyEval_EvalCodeWithName + 0x2f9 (0x559def9db1b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #54: _PyFunction_FastCallDict + 0x3ff (0x559def9dc4cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #55: _PyObject_Call_Prepend + 0x63 (0x559def9fae33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #56: PyObject_Call + 0x6e (0x559def9eda3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #57: _PyEval_EvalFrameDefault + 0x1f3a (0x559defa9512a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #58: _PyEval_EvalCodeWithName + 0x2f9 (0x559def9db1b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #59: _PyFunction_FastCallDict + 0x3ff (0x559def9dc4cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #60: _PyObject_Call_Prepend + 0x63 (0x559def9fae33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #61: <unknown function> + 0x16a2da (0x559defa322da in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #62: PyObject_Call + 0x6e (0x559def9eda3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #63: _PyEval_EvalFrameDefault + 0x1f3a (0x559defa9512a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)

Traceback (most recent call last):
  File "./tools/test.py", line 176, in <module>
    main()
  File "./tools/test.py", line 160, in main
    args.gpu_collect)
  File "/home/huangzixuan/underwater/mmdet/apis/test.py", line 58, in multi_gpu_test
    result = model(return_loss=False, rescale=True, **data)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/parallel/distributed.py", line 442, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/decorators.py", line 71, in new_func
    arg_value, torch.float, torch.half)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/utils.py", line 21, in cast_tensor_type
    cast_tensor_type(item, src_type, dst_type) for item in inputs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/utils.py", line 21, in <genexpr>
    cast_tensor_type(item, src_type, dst_type) for item in inputs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/utils.py", line 9, in cast_tensor_type
    return inputs.to(dst_type)
RuntimeError: CUDA out of memory. Tried to allocate 12.00 MiB (GPU 2; 10.92 GiB total capacity; 1.00 GiB already allocated; 4.50 MiB free; 47.15 MiB cached)
Traceback (most recent call last):
  File "./tools/test.py", line 176, in <module>
    main()
  File "./tools/test.py", line 160, in main
    args.gpu_collect)
  File "/home/huangzixuan/underwater/mmdet/apis/test.py", line 58, in multi_gpu_test
    result = model(return_loss=False, rescale=True, **data)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/parallel/distributed.py", line 442, in forward
    output = self.module(*inputs[0], **kwargs[0])
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 541, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/decorators.py", line 75, in new_func
    output = old_func(*new_args, **new_kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/base.py", line 139, in forward
    return self.forward_test(img, img_meta, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/base.py", line 124, in forward_test
    return self.aug_test(imgs, img_metas, **kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/cascade_rcnn.py", line 414, in aug_test
    self.extract_feats(imgs), img_metas, self.test_cfg.rpn)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/test_mixins.py", line 41, in aug_test_rpn
    proposal_list = self.simple_test_rpn(x, img_meta, rpn_test_cfg)
  File "/home/huangzixuan/underwater/mmdet/models/detectors/test_mixins.py", line 34, in simple_test_rpn
    proposal_list = self.rpn_head.get_bboxes(*proposal_inputs)
  File "/home/huangzixuan/underwater/mmdet/core/fp16/decorators.py", line 152, in new_func
    output = old_func(*new_args, **new_kwargs)
  File "/home/huangzixuan/underwater/mmdet/models/anchor_heads/anchor_head.py", line 276, in get_bboxes
    scale_factor, cfg, rescale)
  File "/home/huangzixuan/underwater/mmdet/models/anchor_heads/rpn_head.py", line 92, in get_bboxes_single
    proposals, _ = nms(proposals, cfg.nms_thr)
  File "/home/huangzixuan/underwater/mmdet/ops/nms/nms_wrapper.py", line 54, in nms
    inds = nms_cuda.nms(dets_th, iou_thr)
RuntimeError: CUDA error: invalid device function (launch_kernel at /opt/conda/conda-bld/pytorch_1570910687650/work/aten/src/ATen/native/cuda/Loops.cuh:102)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x47 (0x7fc4388c6687 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libc10.so)
frame #1: void at::native::gpu_index_kernel<__nv_dl_wrapper_t<__nv_dl_tag<void (*)(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>), &(void at::native::index_kernel_impl<at::native::OpaqueType<8> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>)), 1u>> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>, __nv_dl_wrapper_t<__nv_dl_tag<void (*)(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>), &(void at::native::index_kernel_impl<at::native::OpaqueType<8> >(at::TensorIterator&, c10::ArrayRef<long>, c10::ArrayRef<long>)), 1u>> const&) + 0x78d (0x7fc43f9ae07d in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #2: <unknown function> + 0x543e822 (0x7fc43f9a7822 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #3: <unknown function> + 0x543ecd8 (0x7fc43f9a7cd8 in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #4: <unknown function> + 0x16a5efb (0x7fc43bc0eefb in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #5: at::native::index(at::Tensor const&, c10::ArrayRef<at::Tensor>) + 0x44e (0x7fc43bc09d2e in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #6: <unknown function> + 0x1b9d04a (0x7fc43c10604a in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #7: <unknown function> + 0x366f7ad (0x7fc43dbd87ad in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #8: at::Tensor::index(c10::ArrayRef<at::Tensor>) const + 0xbb (0x7fc43d89f53b in /home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/lib/libtorch.so)
frame #9: nms_cuda(at::Tensor, float) + 0x827 (0x7fc4153f9bd0 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #10: nms(at::Tensor const&, float) + 0x318 (0x7fc4153e86f8 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #11: <unknown function> + 0x42cdd (0x7fc4153f7cdd in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #12: <unknown function> + 0x3fa61 (0x7fc4153f4a61 in /home/huangzixuan/underwater/mmdet/ops/nms/nms_cuda.cpython-37m-x86_64-linux-gnu.so)
frame #13: _PyMethodDef_RawFastCallKeywords + 0x264 (0x55fb97660c34 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #14: _PyCFunction_FastCallKeywords + 0x21 (0x55fb97660d51 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #15: _PyEval_EvalFrameDefault + 0x4ebc (0x55fb976cd0ac in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #16: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #17: _PyFunction_FastCallKeywords + 0x325 (0x55fb976603d5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #18: _PyEval_EvalFrameDefault + 0x416 (0x55fb976c8606 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #19: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #20: _PyFunction_FastCallKeywords + 0x325 (0x55fb976603d5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #21: _PyEval_EvalFrameDefault + 0x4b29 (0x55fb976ccd19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #22: _PyEval_EvalCodeWithName + 0xab8 (0x55fb97610978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #23: _PyFunction_FastCallDict + 0x1d5 (0x55fb976112a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #24: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #25: _PyEval_EvalCodeWithName + 0xab8 (0x55fb97610978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #26: _PyFunction_FastCallDict + 0x1d5 (0x55fb976112a5 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #27: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #28: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #29: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #30: _PyFunction_FastCallKeywords + 0xfb (0x55fb976601ab in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #31: _PyEval_EvalFrameDefault + 0x4b29 (0x55fb976ccd19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #32: _PyEval_EvalCodeWithName + 0xab8 (0x55fb97610978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #33: _PyFunction_FastCallKeywords + 0x387 (0x55fb97660437 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #34: _PyEval_EvalFrameDefault + 0x4b29 (0x55fb976ccd19 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #35: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #36: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #37: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #38: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #39: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #40: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #41: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #42: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #43: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #44: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #45: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #46: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #47: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #48: _PyEval_EvalCodeWithName + 0xab8 (0x55fb97610978 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #49: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #50: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #51: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #52: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #53: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #54: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #55: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #56: <unknown function> + 0x16a2da (0x55fb976672da in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #57: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #58: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #59: _PyEval_EvalCodeWithName + 0x2f9 (0x55fb976101b9 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #60: _PyFunction_FastCallDict + 0x3ff (0x55fb976114cf in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #61: _PyObject_Call_Prepend + 0x63 (0x55fb9762fe33 in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #62: PyObject_Call + 0x6e (0x55fb97622a3e in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)
frame #63: _PyEval_EvalFrameDefault + 0x1f3a (0x55fb976ca12a in /home/huangzixuan/anaconda3/envs/underwater2/bin/python)

Traceback (most recent call last):
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/distributed/launch.py", line 253, in <module>
    main()
  File "/home/huangzixuan/anaconda3/envs/underwater2/lib/python3.7/site-packages/torch/distributed/launch.py", line 249, in main
    cmd=cmd)
subprocess.CalledProcessError: Command '['/home/huangzixuan/anaconda3/envs/underwater2/bin/python', '-u', './tools/test.py', '--local_rank=3', 'configs/cascade_htc_x101_reTrain_multiTest_libra_0322.py', './work_dirs/cascade_x101_64x4d_fpn_htc_reTrain_libra/latest.pth', '--launcher', 'pytorch', '--format_only', '--options', 'jsonfile_prefix=./cascade_htc_x101_multiTest_libra']' died with <Signals.SIGSEGV: 11>.
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
